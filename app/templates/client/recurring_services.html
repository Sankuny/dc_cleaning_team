{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl px-4 mx-auto mt-12">
  <h2 class="mb-8 text-4xl font-bold text-center text-primary">{{ t["recurring_services_title"] }}</h2>

  {% if services %}
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
      {% for s in services %}
        <div class="p-6 bg-white border shadow-md rounded-2xl border-primary/10">
          <h3 class="mb-2 text-lg font-semibold text-primaryDark">{{ t["service_type_labels"][s.service_type] }}</h3>
          
          <p class="mb-1 text-sm text-textSecondary">
            <strong>{{ t["start_date"] }}:</strong> {{ s.start_date.strftime('%Y-%m-%d') }}
          </p>
          <p class="mb-1 text-sm text-textSecondary">
            <strong>{{ t["frequency"] }}:</strong> {{ t["frequency_options"].get(s.frequency, s.frequency) }}
          </p>
          <p class="mb-1 text-sm text-textSecondary">
            <strong>{{ t["address"] }}:</strong> {{ s.address or "N/A" }}
          </p>

          <!-- Estado del servicio -->
          <p class="flex items-center gap-2 mb-2 text-sm text-textSecondary">
            <strong>{{ t["status_label"] }}:</strong>
            {% if s.status == 'active' %}
              <span class="flex items-center font-semibold text-green-600">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20"><circle cx="10" cy="10" r="10"/></svg>
                {{ t["active"] }}
              </span>
            {% elif s.status == 'paused' %}
              <span class="flex items-center font-semibold text-yellow-500">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20">
                  <rect x="4" y="4" width="4" height="12"/>
                  <rect x="12" y="4" width="4" height="12"/>
                </svg>
                {{ t["paused"] }}
              </span>
            {% elif s.status == 'canceled' %}
              <span class="flex items-center font-semibold text-red-500">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20">
                  <path d="M4 4L16 16M16 4L4 16" stroke="currentColor" stroke-width="2"/>
                </svg>
                {{ t["canceled"] }}
              </span>
            {% endif %}
          </p>

          <!-- Acciones -->
          <div class="flex flex-wrap gap-2 mt-3">
            {% if s.status == 'active' %}
              <form method="POST" action="{{ url_for('client.pause_recurring', id=s.id) }}">
                <button type="submit" class="px-4 py-1 text-sm text-white bg-yellow-500 rounded hover:bg-yellow-600">
                  {{ t["pause"] }}
                </button>
              </form>
            {% elif s.status == 'paused' %}
              <form method="POST" action="{{ url_for('client.resume_recurring', id=s.id) }}">
                <button type="submit" class="px-4 py-1 text-sm text-white bg-green-600 rounded hover:bg-green-700">
                  {{ t["resume"] }}
                </button>
              </form>
            {% endif %}

            <form method="POST" action="{{ url_for('client.cancel_recurring', id=s.id) }}">
              <button type="submit" class="px-4 py-1 text-sm text-white bg-red-500 rounded hover:bg-red-600">
                {{ t["cancel"] }}
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="mt-10 text-center text-textSecondary">{{ t["no_recurring_services"] }}</p>
  {% endif %}
</div>
{% endblock %}

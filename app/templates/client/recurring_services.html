{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto mt-12 px-4">
  <h2 class="text-4xl font-bold text-[#003DA5] mb-8 text-center">{{ t["recurring_services_title"] }}</h2>

  {% if services %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for s in services %}
        <div class="bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA]">
          <h3 class="text-lg font-semibold text-[#003DA5] mb-2">{{ t["service_type_labels"][s.service_type] }}</h3>
          
          <p class="text-sm text-gray-600 mb-1">
            <strong>{{ t["start_date"] }}:</strong> {{ s.start_date.strftime('%Y-%m-%d') }}
          </p>
          <p class="text-sm text-gray-600 mb-1">
            <strong>{{ t["frequency"] }}:</strong> {{ t["frequency_options"].get(s.frequency, s.frequency) }}
          </p>
          <p class="text-sm text-gray-600 mb-1">
            <strong>{{ t["address"] }}:</strong> {{ s.address or "N/A" }}
          </p>

          <!-- Estado del servicio -->
          <p class="text-sm text-gray-600 mb-2 flex items-center gap-2">
            <strong>{{ t["status_label"] }}:</strong>
            {% if s.status == 'active' %}
              <span class="flex items-center text-green-600 font-semibold">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20"><circle cx="10" cy="10" r="10"/></svg>
                {{ t["active"] }}
              </span>
            {% elif s.status == 'paused' %}
              <span class="flex items-center text-yellow-500 font-semibold">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20">
                  <rect x="4" y="4" width="4" height="12"/>
                  <rect x="12" y="4" width="4" height="12"/>
                </svg>
                {{ t["paused"] }}
              </span>
            {% elif s.status == 'canceled' %}
              <span class="flex items-center text-red-500 font-semibold">
                <svg class="w-3 h-3 mr-1 fill-current" viewBox="0 0 20 20">
                  <path d="M4 4L16 16M16 4L4 16" stroke="currentColor" stroke-width="2"/>
                </svg>
                {{ t["canceled"] }}
              </span>
            {% endif %}
          </p>

          <!-- Acciones -->
          <div class="flex flex-wrap gap-2 mt-3">
            {% if s.status == 'active' %}
              <form method="POST" action="{{ url_for('client.pause_recurring', id=s.id) }}">
                <button type="submit" class="bg-yellow-500 text-white px-4 py-1 rounded hover:bg-yellow-600 text-sm">
                  {{ t["pause"] }}
                </button>
              </form>
            {% elif s.status == 'paused' %}
              <form method="POST" action="{{ url_for('client.resume_recurring', id=s.id) }}">
                <button type="submit" class="bg-green-600 text-white px-4 py-1 rounded hover:bg-green-700 text-sm">
                  {{ t["resume"] }}
                </button>
              </form>
            {% endif %}

            <form method="POST" action="{{ url_for('client.cancel_recurring', id=s.id) }}">
              <button type="submit" class="bg-red-500 text-white px-4 py-1 rounded hover:bg-red-600 text-sm">
                {{ t["cancel"] }}
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-center text-gray-500 mt-10">{{ t["no_recurring_services"] }}</p>
  {% endif %}
</div>
{% endblock %}


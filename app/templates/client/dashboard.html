{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto mt-12 px-4">

  <!-- ðŸ”” NotificaciÃ³n de servicios por calificar -->
  {% if to_rate %}
    <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg mb-8 shadow">
      <p class="font-semibold mb-1">{{ t["pending_rating_title"] }}</p>
      <p class="text-sm">{{ t["pending_rating_desc"] }}</p>
      <a href="{{ url_for('client.rate_service') }}" class="inline-block mt-2 bg-blue-600 text-white text-sm px-4 py-1 rounded hover:bg-blue-700">
        {{ t["rate_now"] }}
      </a>
    </div>
  {% endif %}

  <!-- ðŸ‘‹ Bienvenida -->
  <h2 class="text-4xl font-bold text-[#003DA5] mb-6 text-center">{{ t["welcome"] }}, {{ name }}!</h2>

 <!-- ðŸ•’ Ãšltima solicitud de servicio con tracking -->
{% if latest_service %}
<div class="bg-white border border-blue-200 p-6 rounded-lg shadow mb-10">
  <h3 class="text-lg font-bold text-blue-800 mb-4">{{ t["latest_request_status"] }}</h3>
  <p class="text-sm text-gray-600 mb-2">{{ t["service_type"] }}: <strong>{{ t["service_type_labels"][latest_service.service_type] }}</strong></p>
  <p class="text-sm text-gray-600 mb-6">{{ t["date"] }}: {{ latest_service.date.strftime('%Y-%m-%d') }}</p>

  <!-- Tracking visual RESPONSIVE con Lucide -->
  <div class="flex flex-col md:flex-row items-center justify-between text-sm font-medium text-gray-600 gap-4 md:gap-0">

    <!-- Paso 1 -->
    <div class="flex flex-col items-center w-full">
      <div class="w-10 h-10 flex items-center justify-center rounded-full
        {% if latest_service.status in ['pending', 'accepted', 'assigned', 'completed_by_employee', 'completed'] %}
          bg-blue-600 text-white animate-pulse
        {% else %}
          bg-gray-300 text-gray-500
        {% endif %}">
        <i data-lucide="file-text" class="w-6 h-6"></i>
      </div>
      <span class="mt-2 text-center text-xs">{{ t["status_labels"]["pending"] }}</span>
    </div>

    <!-- LÃ­nea -->
    <div class="hidden md:flex flex-1 h-1 bg-gradient-to-r from-blue-600 to-blue-200 mx-1"></div>

    <!-- Paso 2 -->
    <div class="flex flex-col items-center w-full">
      <div class="w-10 h-10 flex items-center justify-center rounded-full
        {% if latest_service.status in ['accepted', 'assigned', 'completed_by_employee', 'completed'] %}
          bg-green-600 text-white animate-pulse
        {% else %}
          bg-gray-300 text-gray-500
        {% endif %}">
        <i data-lucide="check-circle" class="w-6 h-6"></i>
      </div>
      <span class="mt-2 text-center text-xs">{{ t["status_labels"]["accepted"] }}</span>
    </div>

    <div class="hidden md:flex flex-1 h-1 bg-gradient-to-r from-green-600 to-green-200 mx-1"></div>

    <!-- Paso 3 -->
    <div class="flex flex-col items-center w-full">
      <div class="w-10 h-10 flex items-center justify-center rounded-full
        {% if latest_service.status in ['assigned', 'completed_by_employee', 'completed'] %}
          bg-blue-500 text-white animate-pulse
        {% else %}
          bg-gray-300 text-gray-500
        {% endif %}">
        <i data-lucide="user-cog" class="w-6 h-6"></i>
      </div>
      <span class="mt-2 text-center text-xs">{{ t["status_labels"]["assigned"] }}</span>
    </div>

    <div class="hidden md:flex flex-1 h-1 bg-gradient-to-r from-purple-600 to-purple-200 mx-1"></div>

    <!-- Paso 4 -->
    <div class="flex flex-col items-center w-full">
      <div class="w-10 h-10 flex items-center justify-center rounded-full
        {% if latest_service.status in ['completed_by_employee', 'completed'] %}
          bg-purple-600 text-white animate-pulse
        {% else %}
          bg-gray-300 text-gray-500
        {% endif %}">
        <i data-lucide="hourglass" class="w-6 h-6"></i>
      </div>
      <span class="mt-2 text-center text-xs">{{ t["status_labels"]["completed_by_employee"] }}</span>
    </div>

    <div class="hidden md:flex flex-1 h-1 bg-gradient-to-r from-yellow-500 to-yellow-200 mx-1"></div>

    <!-- Paso 5 -->
    <div class="flex flex-col items-center w-full">
      <div class="w-10 h-10 flex items-center justify-center rounded-full
        {% if latest_service.status == 'completed' %}
          bg-yellow-500 text-white animate-pulse
        {% else %}
          bg-gray-300 text-gray-500
        {% endif %}">
        <i data-lucide="star" class="w-6 h-6"></i>
      </div>
      <span class="mt-2 text-center text-xs">{{ t["status_labels"]["completed"] }}</span>
    </div>

  </div>
</div>
{% endif %}



  <!-- ðŸ“¦ Funcionalidades -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

    <!-- Solicitar servicio -->
    <a href="{{ url_for('client.request_service') }}"
       class="group block bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA] text-center
              hover:shadow-xl hover:scale-105 transform transition duration-500">
      <img src="{{ url_for('static', filename='img/Request.png') }}" alt="Request" class="mx-auto mb-4 w-20 h-20 group-hover:scale-110 transition duration-300">
      <h2 class="text-xl font-semibold text-[#003DA5] mb-2">{{ t["request_service_title"] }}</h2>
      <p class="text-gray-600 text-sm">{{ t["request_service_desc"] }}</p>
    </a>

    <!-- Calificar servicio -->
    <a href="{{ url_for('client.rate_service') }}"
       class="group block bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA] text-center
              hover:shadow-xl hover:scale-105 transform transition duration-500">
      <img src="{{ url_for('static', filename='img/rate.png') }}" alt="Rate" class="mx-auto mb-4 w-20 h-20 group-hover:scale-110 transition duration-300">
      <h2 class="text-xl font-semibold text-[#003DA5] mb-2">{{ t["rate_service_title"] }}</h2>
      <p class="text-gray-600 text-sm">{{ t["rate_service_desc"] }}</p>
    </a>

    <!-- Historial de servicios -->
    <a href="{{ url_for('client.service_history') }}"
       class="group block bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA] text-center
              hover:shadow-xl hover:scale-105 transform transition duration-500">
      <img src="{{ url_for('static', filename='img/hitory.png') }}" alt="History" class="mx-auto mb-4 w-20 h-20 group-hover:scale-110 transition duration-300">
      <h2 class="text-xl font-semibold text-[#003DA5] mb-2">{{ t["service_history_title"] }}</h2>
      <p class="text-gray-600 text-sm">{{ t["service_history_desc"] }}</p>
    </a>

    <!-- Perfil -->
    <a href="{{ url_for('client.profile') }}"
       class="group block bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA] text-center
              hover:shadow-xl hover:scale-105 transform transition duration-500">
      <img src="{{ url_for('static', filename='img/profile.png') }}" alt="Profile" class="mx-auto mb-4 w-20 h-20 group-hover:scale-110 transition duration-300">
      <h2 class="text-xl font-semibold text-[#003DA5] mb-2">{{ t["profile_title"] }}</h2>
      <p class="text-gray-600 text-sm">{{ t["profile_desc"] }}</p>
    </a>

    <!-- Servicios recurrentes -->
    <a href="{{ url_for('client.recurring_services') }}"
       class="group block bg-white shadow-md rounded-2xl p-6 border border-[#EBF2FA] text-center
              hover:shadow-xl hover:scale-105 transform transition duration-500">
      <img src="{{ url_for('static', filename='img/recurrente.png') }}" alt="Recurring" class="mx-auto mb-4 w-20 h-20 group-hover:scale-110 transition duration-300">
      <h2 class="text-xl font-semibold text-[#003DA5] mb-2">{{ t["recurring_service_title"] }}</h2>
      <p class="text-gray-600 text-sm">{{ t["recurring_service_desc"] }}</p>
    </a>

  </div>
</div>
{% endblock %}

